<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="2400" viewBox="0 0 1400 2400"><style>text{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans CJK JP","Noto Sans JP",Meiryo,Arial,sans-serif;font-size:16px;fill:#111} .box{fill:#fff;stroke:#444;stroke-width:1.5} .diamond{fill:#fff;stroke:#444;stroke-width:1.5} .title{font-size:22px;font-weight:600} .caption{font-size:13px;fill:#555} .lane{fill:#f6f7f9;stroke:#e2e2e2} .note{fill:#fff3cd;stroke:#e0c36c} </style><defs><marker id="arrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#444"/></marker></defs><text x="24" y="34" text-anchor="start">NodeVision Edit : ユーザーワークフロー（アクティビティ）</text><text x="24" y="58" text-anchor="start">MVPフロー（要件v1.0.6準拠）</text><circle cx="700.0" cy="60" r="10" fill="#444"/><rect x="480.0" y="90" width="440" height="48" rx="8" ry="8" class="box" /><text x="700.0" y="120" text-anchor="middle">アプリ起動</text><line x1="700.0" y1="80" x2="700.0" y2="90" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><rect x="400.0" y="170" width="600" height="70" rx="8" ry="8" class="box" /><text x="700.0" y="196" text-anchor="middle">ヘルスチェック</text><text x="700.0" y="216" text-anchor="middle">(ffprobe検出 / NV_HTTP_TOKEN生成)</text><line x1="700.0" y1="138" x2="700.0" y2="170" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><polygon points="700.0,255.0 810.0,300 700.0,345.0 590.0,300" class="diamond" /><text x="700.0" y="300" text-anchor="middle">FFmpeg / ffprobe OK?</text><line x1="700.0" y1="240" x2="700.0" y2="270" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><text x="580.0" y="280" text-anchor="end">Yes</text><rect x="240.0" y="370" width="400" height="56" rx="8" ry="8" class="box" /><text x="440.0" y="403" text-anchor="middle">プロジェクト新規 / 読み込み</text><line x1="590.0" y1="330" x2="440.0" y2="370" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><text x="820.0" y="280" text-anchor="start">No</text><rect x="800.0" y="310" width="400" height="56" rx="6" ry="6" class="note" /><text x="1000.0" y="336" text-anchor="middle">設定画面へ誘導</text><text x="1000.0" y="356" text-anchor="middle">(E1001 FfmpegNotFound)</text><line x1="810.0" y1="330" x2="800.0" y2="338" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><circle cx="1000.0" cy="400" r="10" fill="#444"/><line x1="1000.0" y1="366" x2="1000.0" y2="390" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><rect x="24" y="440" width="1352" height="280" rx="8" ry="8" class="lane" /><text x="36" y="462" text-anchor="start">編集セクション</text><rect x="440.0" y="470" width="520" height="56" rx="8" ry="8" class="box" /><text x="700.0" y="503" text-anchor="middle">ノード追加 / 接続 / プロパティ編集</text><line x1="700.0" y1="400" x2="700.0" y2="470" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><rect x="440.0" y="560" width="520" height="56" rx="8" ry="8" class="box" /><text x="700.0" y="593" text-anchor="middle">オートセーブ(アイドル2s)・Undo/Redo(上限100)</text><line x1="700.0" y1="526" x2="700.0" y2="560" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><polygon points="700.0,645.0 810.0,690 700.0,735.0 590.0,690" class="diamond" /><text x="700.0" y="690" text-anchor="middle">Concat対象が含まれる?</text><line x1="700.0" y1="624" x2="700.0" y2="660" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><text x="580.0" y="672" text-anchor="end">Yes</text><rect x="180.0" y="760" width="400" height="56" rx="8" ry="8" class="box" /><text x="380.0" y="793" text-anchor="middle">inspect/concat 呼び出し (IPC/HTTP)</text><line x1="590.0" y1="720" x2="380.0" y2="760" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><polygon points="380.0,845.0 490.0,890 380.0,935.0 270.0,890" class="diamond" /><text x="380.0" y="890" text-anchor="middle">一致判定 OK?</text><line x1="380.0" y1="816" x2="380.0" y2="860" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><text x="500.0" y="872" text-anchor="start">No</text><rect x="160.0" y="970" width="440" height="56" rx="6" ry="6" class="note" /><text x="380.0" y="1000" text-anchor="middle">エラーバナー E2001</text><text x="380.0" y="1020" text-anchor="middle">(解像度/fps/pix_fmt 不一致)</text><line x1="380.0" y1="920" x2="380.0" y2="970" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><line x1="600.0" y1="998" x2="440.0" y2="480" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><text x="260.0" y="872" text-anchor="end">Yes</text><line x1="380.0" y1="920" x2="700.0" y2="920" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><rect x="460.0" y="980" width="480" height="56" rx="8" ry="8" class="box" /><text x="700.0" y="1013" text-anchor="middle">Export / プレビュー実行 指示</text><line x1="700.0" y1="920" x2="700.0" y2="980" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><rect x="500.0" y="1070" width="400" height="56" rx="8" ry="8" class="box" /><text x="700.0" y="1103" text-anchor="middle">engine:run 送信（ジョブ投入・単一キュー）</text><line x1="700.0" y1="1036" x2="700.0" y2="1070" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><text x="700.0" y="1152" text-anchor="middle">並行処理</text><rect x="145.0" y="1160" width="360" height="70" rx="8" ry="8" class="box" /><text x="325.0" y="1186" text-anchor="middle">プレビュー生成</text><text x="325.0" y="1206" text-anchor="middle">(image2pipe JPEG / 過負荷時は最新のみ描画)</text><rect x="520.0" y="1160" width="360" height="70" rx="8" ry="8" class="box" /><text x="700.0" y="1186" text-anchor="middle">進捗受信</text><text x="700.0" y="1206" text-anchor="middle">(ratio/fps/time)</text><rect x="895.0" y="1160" width="360" height="70" rx="8" ry="8" class="box" /><text x="1075.0" y="1186" text-anchor="middle">キャンセル受付</text><text x="1075.0" y="1206" text-anchor="middle">(SIGINT→3s→SIGKILL)</text><line x1="700.0" y1="1126" x2="325.0" y2="1160" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><line x1="700.0" y1="1126" x2="700.0" y2="1160" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><line x1="700.0" y1="1126" x2="1075.0" y2="1160" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><polygon points="700.0,1275.0 810.0,1320 700.0,1365.0 590.0,1320" class="diamond" /><text x="700.0" y="1320" text-anchor="middle">ffmpeg 終了コード == 0 ?</text><line x1="700.0" y1="1230" x2="700.0" y2="1275" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><text x="580.0" y="1310" text-anchor="end">Yes</text><rect x="200.0" y="1410" width="400" height="56" rx="8" ry="8" class="box" /><text x="400.0" y="1443" text-anchor="middle">一時名→アトミックrenameで保存</text><line x1="590.0" y1="1350" x2="400.0" y2="1410" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><rect x="200.0" y="1500" width="400" height="56" rx="8" ry="8" class="box" /><text x="400.0" y="1533" text-anchor="middle">履歴に追加（20件ローテーション）</text><line x1="400.0" y1="1466" x2="400.0" y2="1500" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><rect x="200.0" y="1590" width="400" height="56" rx="8" ry="8" class="box" /><text x="400.0" y="1623" text-anchor="middle">完了通知</text><line x1="400.0" y1="1556" x2="400.0" y2="1590" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><circle cx="400.0" cy="1690" r="10" fill="#444"/><line x1="400.0" y1="1646" x2="400.0" y2="1670" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><text x="820.0" y="1310" text-anchor="start">No</text><rect x="780.0" y="1370" width="440" height="56" rx="6" ry="6" class="note" /><text x="1000.0" y="1400" text-anchor="middle">エラーバナー（コード/要約）表示</text><line x1="810.0" y1="1350" x2="780.0" y2="1398" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><rect x="780.0" y="1460" width="440" height="56" rx="8" ry="8" class="box" /><text x="1000.0" y="1490" text-anchor="middle">ログ参照可能（cmd / stderr_head / elapsedMs）</text><line x1="1000.0" y1="1426" x2="1000.0" y2="1460" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /><circle cx="1000.0" cy="1540" r="10" fill="#444"/><line x1="1000.0" y1="1516" x2="1000.0" y2="1540" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)" /></svg>